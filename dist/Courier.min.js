/*! Courier.js - v0.1.0 - 2012-12-12
* https://github.com/Problematic/Courier
* Copyright (c) 2012 Derek Stobbe; Licensed MIT */
(function(e,t){"use strict";var n=[].slice,r=function(e){var t=n.call(arguments,1),r;for(var i=0;i<t.length;i++){r=t[i];for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])}return e},i=function(e){var t={ephemeral:!1,transformers:[],bubbleErrors:!1};return typeof e=="function"?t.transformers=[e]:e instanceof Array?t.transformers=e:typeof e=="boolean"?t.ephemeral=e:typeof e=="object"&&(t=r(t,e),t.transformer&&(t.transformer instanceof Array?t.transformers=t.transformer:t.transformers.push(t.transformer),delete t.transformer)),t},s={Storage:null,EphemeralStorage:null,transformers:{},getStorage:function(e){return e&&this.EphemeralStorage||this.Storage},transform:function(e,t){var n;for(var r=0;r<t.transformers.length;r++){n=t.transformers[r];if(typeof n=="function")try{e=n(e)}catch(i){if(t.bubbleErrors)throw i}}return e},registerTransformer:function(e,t){this.transformers[e]=t},clear:function(e){return this.getStorage(e).clear()},get:function(e,t){var n;return t=i(t),n=this.getStorage(t.ephemeral).getItem(e),this.transform(n,t)},length:function(e){return this.getStorage(e).length},remove:function(e,t){return this.getStorage(t).removeItem(e)},set:function(e,t,n){return n=i(n),t=this.transform(t,n),this.getStorage(n.ephemeral).setItem(e,t)}};s.registerTransformer("object",function(e){return typeof e=="string"?JSON.parse(e):typeof e=="object"?JSON.stringify(e):e}),s.registerTransformer("boolean",function(e){if(typeof e=="string")switch(e){case"true":return!0;case"false":return!1;case"null":return null}return e}),s.Storage=e.localStorage||null,s.EphemeralStorage=e.sessionStorage||null,typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=s),exports.Courier=s):(e.Courier=s,typeof define=="function"&&typeof define.amd=="object"&&define(s))})(this);